read.csv("https://www.gunviolencearchive.org/export-finished?filename=public%3A//export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv&uuid=436a0477-9747-4396-a32c-71086dcce9bf&return_href=reports/officer-killed%3Fyear%3D2022")
read.csv("https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv")
read.csv("https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv")
getwd()
# 2022
K2022 <- read_csv("https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv")
require(haven)
# 2022
K2022 <- read_csv("https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv")
# 2022
K2022 <- read_csv("https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv")
## ---------------------------
##
## Script name: read.R
##
## Purpose of script: To read in 2018-2023 records from GVA website.
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##   This is to read all record files from GVA website for the homeboy drop off project
##  that I worked on with Dr. Prachi Sanghavi.
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/Documents/GitHub/homeboydropoff")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
require(haven)
## ---------------------------
# 2023
# 2022
K2022 <- read_csv("https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv")
K2022
colnames(K2022)
K2022[1,]
View(K2022)
# 2022
K2022 <- fread("https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv")
head(K2022)
str(K2022)
test <- fread("https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//export-aaaef91b-0fbf-4a0a-8219-c6b5f387ce6e.csv")
I2022 <- fread("https://www.gunviolencearchive.org/export-finished?filename=public%3A//export-aaaef91b-0fbf-4a0a-8219-c6b5f387ce6e.csv&uuid=79a1ad78-8111-48b8-a5f3-b248a9d04527&return_href=reports/officer-shot%3Fyear%3D2022#:~:text=search%20results%20page.-,Download,-Return%20to%20Search")
View(I2022)
test <- fread("https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//export-aaaef91b-0fbf-4a0a-8219-c6b5f387ce6e.csv")
test2 <- fread("https://www.gunviolencearchive.org/export-finished/download?uuid=79a1ad78-8111-48b8-a5f3-b248a9d04527&filename=public%3A//export-aaaef91b-0fbf-4a0a-8219-c6b5f387ce6e.csv")
# 2022
K2022 <- fread(paste0(prefix, "export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv"))
I2022 <- fread(paste0(prefix, "export-aaaef91b-0fbf-4a0a-8219-c6b5f387ce6e.csv"))
## ---------------------------
##
## Script name: read.R
##
## Purpose of script: To read in 2018-2023 records from GVA website.
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##   This is to read all record files from GVA website for the homeboy drop off project
##  that I worked on with Dr. Prachi Sanghavi.
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/Documents/GitHub/homeboydropoff")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
## ---------------------------
prefix <- "https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//"
# 2023
K2023 <- fread(paste0(prefix, "export-e9cadfb9-6eac-43ce-9804-17c2893f01a6.csv"))
I2023 <- fread(paste0(prefix, "export-849e34d3-4fda-48d0-80d1-53bfaa95b410.csv"))
View(I2023)
## ---------------------------
##
## Script name: read.R
##
## Purpose of script: To read in 2018-2023 records from GVA website.
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##   This is to read all record files from GVA website for the homeboy drop off project
##  that I worked on with Dr. Prachi Sanghavi.
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/Documents/GitHub/homeboydropoff")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
## ---------------------------
prefix <- "https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//"
# 2023
K2023 <- fread(paste0(prefix, "export-e9cadfb9-6eac-43ce-9804-17c2893f01a6.csv"))
I2023 <- fread(paste0(prefix, "export-849e34d3-4fda-48d0-80d1-53bfaa95b410.csv"))
# 2022
K2022 <- fread(paste0(prefix, "export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv"))
I2022 <- fread(paste0(prefix, "export-aaaef91b-0fbf-4a0a-8219-c6b5f387ce6e.csv"))
# 2021
K2021 <- fread(paste0(prefix, "export-00261eef-de98-4efc-9bc9-e09ea1c03cd2.csv"))
I2021 <- fread(paste0(prefix, "export-fbf17a22-aab7-4c53-99bf-f268152fffc2.csv"))
# 2020
K2020 <- fread(paste0(prefix, "export-2ee1216a-f11b-4cf2-895d-3e81f55058bc.csv"))
I2020 <- fread(paste0(prefix, "export-5ec9be8d-b570-4e1d-b8d8-e8c787d15bce.csv"))
# 2019
K2019 <- fread(paste0(prefix, "export-126979de-4456-4960-b761-daa6c2272756.csv"))
I2019 <- fread(paste0(prefix, "export-d39f0b61-43b5-4e45-b5ee-e2c421c02e34.csv"))
# 2018
A2018 <- fread(paste0(prefix, "export-eb4c5abd-c297-4966-8dc6-435cc744a672.csv"))
test
View(A2018)
?fread
View(A2018)
colnames(A2018)
# 2023
K2023 <- fread(paste0(prefix, "export-e9cadfb9-6eac-43ce-9804-17c2893f01a6.csv"), colClasses = c("Incident Date"="Date"))
??fastPOSIXct
install.packages("fasttime")
?fastPOSIXct
??fastPOSIXct
# 2023
K2023 <- fread(paste0(prefix, "export-e9cadfb9-6eac-43ce-9804-17c2893f01a6.csv"), check.names=TRUE)
colnames(K2023)
## ---------------------------
##
## Script name: read.R
##
## Purpose of script: To read in 2018-2023 records from GVA website.
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##   This is to read all record files from GVA website for the homeboy drop off project
##  that I worked on with Dr. Prachi Sanghavi.
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/Documents/GitHub/homeboydropoff")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
## ---------------------------
prefix <- "https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//"
# 2023
K2023 <- fread(paste0(prefix, "export-e9cadfb9-6eac-43ce-9804-17c2893f01a6.csv"), check.names=TRUE)
I2023 <- fread(paste0(prefix, "export-849e34d3-4fda-48d0-80d1-53bfaa95b410.csv"), check.names=TRUE)
# 2022
K2022 <- fread(paste0(prefix, "export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv"), check.names=TRUE)
I2022 <- fread(paste0(prefix, "export-aaaef91b-0fbf-4a0a-8219-c6b5f387ce6e.csv"), check.names=TRUE)
# 2021
K2021 <- fread(paste0(prefix, "export-00261eef-de98-4efc-9bc9-e09ea1c03cd2.csv"), check.names=TRUE)
I2021 <- fread(paste0(prefix, "export-fbf17a22-aab7-4c53-99bf-f268152fffc2.csv"), check.names=TRUE)
# 2020
K2020 <- fread(paste0(prefix, "export-2ee1216a-f11b-4cf2-895d-3e81f55058bc.csv"), check.names=TRUE)
I2020 <- fread(paste0(prefix, "export-5ec9be8d-b570-4e1d-b8d8-e8c787d15bce.csv"), check.names=TRUE)
# 2019
K2019 <- fread(paste0(prefix, "export-126979de-4456-4960-b761-daa6c2272756.csv"), check.names=TRUE)
I2019 <- fread(paste0(prefix, "export-d39f0b61-43b5-4e45-b5ee-e2c421c02e34.csv"), check.names=TRUE)
# 2018
A2018 <- fread(paste0(prefix, "export-eb4c5abd-c297-4966-8dc6-435cc744a672.csv"), check.names=TRUE)
# Save all raw data file for later cleaning and merging
View(A2018)
View(A2018)
View(K2023)
require(lubridate)
colnames(A2018)
## ---------------------------
##
## Script name: read.R
##
## Purpose of script: To read in 2018-2023 records from GVA website.
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##   This is to read all record files from GVA website for the homeboy drop off project
##  that I worked on with Dr. Prachi Sanghavi.
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/Documents/GitHub/homeboydropoff")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
require(lubridate)
## ---------------------------
prefix <- "https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//"
# 2023
K2023 <- fread(paste0(prefix, "export-e9cadfb9-6eac-43ce-9804-17c2893f01a6.csv"), check.names=TRUE) %>%
mutate(Incident.Date = mdy(Incident.Date))
save(K2023, I2023,
K2022, I2022,
K2021, I2021,
K2020, I2020,
K2019, I2019,
A2018, "data/rawrecords.Rdata")
## ---------------------------
##
## Script name: read.R
##
## Purpose of script: To read in 2018-2023 records from GVA website.
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##   This is to read all record files from GVA website for the homeboy drop off project
##  that I worked on with Dr. Prachi Sanghavi.
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/Documents/GitHub/homeboydropoff")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
## ---------------------------
prefix <- "https://www.gunviolencearchive.org/export-finished/download?uuid=436a0477-9747-4396-a32c-71086dcce9bf&filename=public%3A//"
# 2023
K2023 <- fread(paste0(prefix, "export-e9cadfb9-6eac-43ce-9804-17c2893f01a6.csv"), check.names=TRUE)
I2023 <- fread(paste0(prefix, "export-849e34d3-4fda-48d0-80d1-53bfaa95b410.csv"), check.names=TRUE)
# 2022
K2022 <- fread(paste0(prefix, "export-ac8e6404-47e0-4750-b741-21ce08a41bd6.csv"), check.names=TRUE)
I2022 <- fread(paste0(prefix, "export-aaaef91b-0fbf-4a0a-8219-c6b5f387ce6e.csv"), check.names=TRUE)
# 2021
K2021 <- fread(paste0(prefix, "export-00261eef-de98-4efc-9bc9-e09ea1c03cd2.csv"), check.names=TRUE)
I2021 <- fread(paste0(prefix, "export-fbf17a22-aab7-4c53-99bf-f268152fffc2.csv"), check.names=TRUE)
# 2020
K2020 <- fread(paste0(prefix, "export-2ee1216a-f11b-4cf2-895d-3e81f55058bc.csv"), check.names=TRUE)
I2020 <- fread(paste0(prefix, "export-5ec9be8d-b570-4e1d-b8d8-e8c787d15bce.csv"), check.names=TRUE)
# 2019
K2019 <- fread(paste0(prefix, "export-126979de-4456-4960-b761-daa6c2272756.csv"), check.names=TRUE)
I2019 <- fread(paste0(prefix, "export-d39f0b61-43b5-4e45-b5ee-e2c421c02e34.csv"), check.names=TRUE)
# 2018
A2018 <- fread(paste0(prefix, "export-eb4c5abd-c297-4966-8dc6-435cc744a672.csv"), check.names=TRUE)
# Save all raw data file for later cleaning and merging
save(K2023, I2023,
K2022, I2022,
K2021, I2021,
K2020, I2020,
K2019, I2019,
A2018, "data/rawrecords.Rdata")
# Save all raw data file for later cleaning and merging
save(K2023, I2023,
K2022, I2022,
K2021, I2021,
K2020, I2020,
K2019, I2019,
A2018,
file="data/rawrecords.Rdata")
## ---------------------------
##
## Script name: clean.R
##
## Purpose of script:
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
## ---------------------------
# STEP 1
# Read in the data
load("data/rawrecords.Rda
a")
## ---------------------------
##
## Script name: clean.R
##
## Purpose of script:
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
## ---------------------------
# STEP 1
# Read in the data
load("data/rawrecords.Rdata")
## ---------------------------
##
## Script name: clean.R
##
## Purpose of script: To clean the raw record files downloaded from GVA website.
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##   1. Time-wise: drop all records outside the analysis period, from 2018-04-20 to 2023-04-20
##   2. GVA data is stored in another format for all records prior to 2019-01-01. So for our analysis,
##      meaning we would need to do extra cleaning and proofreading for 2018 records since the GVA file
##      also includes cases where police were engaged but no officer was shot or killed. Such cleaning
##      cannot really be automated easily so would be done by hand outside this script.
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/Documents/GitHub/homeboydropoff")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
## ---------------------------
# STEP 1
# Read in the data
load("data/rawrecords.Rdata")
# Change the date column formate
K2023 <- mutate(k2023, Incident.Date = mdy(Incident.Date))
# Change the date column formate
K2023 <- mutate(K2023, Incident.Date = mdy(Incident.Date))
View(K2023)
View(K2022)
K2022 <- mutate(K2022, Incident.Date = mdy(Incident.Date))
View(A2018)
## ---------------------------
##
## Script name: clean.R
##
## Purpose of script: To clean the raw record files downloaded from GVA website.
##
## Author: Cal Chengqi Fang
##
## Date Created: 2023-09-26
##
## Copyright (c) Cal Chengqi Fang, 2023
## Email: cal.cf@uchicago.edu
##
## ---------------------------
##
## Notes:
##   1. Time-wise: drop all records outside the analysis period, from 2018-04-20 to 2023-04-20
##   2. GVA data is stored in another format for all records prior to 2019-01-01. So for our analysis,
##      meaning we would need to do extra cleaning and proofreading for 2018 records since the GVA file
##      also includes cases where police were engaged but no officer was shot or killed. Such cleaning
##      cannot really be automated easily so would be done by hand outside this script.
##
## ---------------------------
## set working directory for Mac and PC
setwd("/Users/atchoo/Documents/GitHub/homeboydropoff")  # Cal's working directory (mac)
# setwd("C:/Users/")     # Cal's working directory (PC)
## ---------------------------
rm(list=ls())
options(scipen=6, digits=4)         # I prefer to view outputs in non-scientific notation
memory.limit(30000000)                  # this is needed on some PCs to increase memory allowance, but has no impact on macs.
## ---------------------------
## load up the packages we will need:  (uncomment as required)
require(tidyverse)
require(data.table)
## ---------------------------
# STEP 1
# Read in the data
load("data/rawrecords.Rdata")
# Change the date column format for each data.table
K2023 <- mutate(K2023, Incident.Date = mdy(Incident.Date))
I2023 <- mutate(I2023, Incident.Date = mdy(Incident.Date))
K2022 <- mutate(K2022, Incident.Date = mdy(Incident.Date))
I2022 <- mutate(I2022, Incident.Date = mdy(Incident.Date))
K2021 <- mutate(K2021, Incident.Date = mdy(Incident.Date))
I2021 <- mutate(I2021, Incident.Date = mdy(Incident.Date))
K2020 <- mutate(K2020, Incident.Date = mdy(Incident.Date))
I2020 <- mutate(I2020, Incident.Date = mdy(Incident.Date))
K2019 <- mutate(K2019, Incident.Date = mdy(Incident.Date))
I2019 <- mutate(I2019, Incident.Date = mdy(Incident.Date))
A2018 <- mutate(A2018, Incident.Date = mdy(Incident.Date))
# STEP 2
# Time-wise clean for 2023 and 2018 file
K2023 <- filter(K2023, Incident.Date <= "2023-04-30")
I2023 <- filter(I2023, Incident.Date <= "2023-04-30")
A2018 <- filter(A2018, Incident.Date >= "2018-04-30")
View(A2018)
